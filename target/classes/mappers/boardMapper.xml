<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bcc.mapper.BoardMapper">

	<select id="listAll" resultType="BoardVO">
		<![CDATA[
		select * from tourist_spot
		where num > 0
		order by num asc
		]]>
	</select>

	<select id="getBoard" resultType="BoardVO">
		select
		*
		from
		tourist_spot
		where
		num =
		#{num}
	</select>

	<select id="updateBoardCnt" resultType="BoardVO"
		parameterType="int">
		update tourist_spot set totalCount = totalCount + 1
		where num = #{num}

	</select>

	<select id="category" resultType="BoardVO"
		parameterType="String">
		select *
		from tourist_spot
		where GUGUN_NM = #{category}
	</select>

	<select id="listPage" resultType="BoardVO">
 		<![CDATA[
 		select * from tourist_spot
 		where num > 0
 		order by num asc
 		limit 0, 10
 		]]>
	</select>

	<select id="listCri" resultType="BoardVO">
 		<![CDATA[
 		select * from tourist_spot
 		where 1=1
 		]]>
		<include refid="search"></include>	
 			<![CDATA[
 		and num > 0
 		order by num asc
 		limit #{pageStart}, #{perPageNum}
 		]]>
	</select>

	<select id="listCount" resultType="int">
	<![CDATA[
		select count(num)
		from tourist_spot where 1=1
	]]>
		<include refid="search"></include>	
			<![CDATA[
		and num > 0	
		 ]]>
	</select>
	
	
	<sql id="search">
		<if test="searchType != null">
			<if test="searchType == 't'.toString()">AND MAIN_TITLE LIKE CONCAT('%', #{keyword} ,'%')</if>
			<if test="searchType == 'c'.toString()">AND ADDR1 LIKE '%' #{keyword} '%'</if>
			<if test="searchType == 'tc'.toString()">AND (MAIN_TITLE LIKE '%' #{keyword} '%') or (ADDR1 LIKE '%' #{keyword} '%')</if>
		</if>
	</sql>

</mapper>